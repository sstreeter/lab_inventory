#!/bin/bash

# Creates or updates a persistent directory snapshot
SNAPSHOT_DIR="scaffold_snapshots"
mkdir -p "$SNAPSHOT_DIR"

NOW=$(date +"%Y%m%d_%H%M%S")
TARGET="$SNAPSHOT_DIR/scaffold_$NOW"

rsync -av --exclude='__pycache__' \
          --exclude='*.log' \
          --exclude='*.pyc' \
          --exclude='*.DS_Store' \
          --exclude='frontend/node_modules' \
          lab_inventory/ "$TARGET"

echo "Scaffold snapshot saved: $TARGET"

LATEST_LINK="$SNAPSHOT_DIR/latest"
rm -f "$LATEST_LINK"
ln -s "$TARGET" "$LATEST_LINK"
ecdho "Symlink 'latest' now points to: $TARGET"
dd